--// Orange Snipe GUI //--

local Players = game:GetService("Players")
local Http = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer
local Api = "https://games.roblox.com/v1/games/"
local PlaceId = game.PlaceId

-- UI LIB (simple orange draggable)
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
local Frame = Instance.new("Frame", ScreenGui)
local UICorner = Instance.new("UICorner", Frame)
local Title = Instance.new("TextLabel", Frame)
local TextBox = Instance.new("TextBox", Frame)
local Button = Instance.new("TextButton", Frame)
local Status = Instance.new("TextLabel", Frame)

Frame.Size = UDim2.new(0, 250, 0, 150)
Frame.Position = UDim2.new(0.35, 0, 0.35, 0)
Frame.BackgroundColor3 = Color3.fromRGB(255,140,0) -- orange
Frame.Active = true
Frame.Draggable = true

UICorner.CornerRadius = UDim.new(0, 10)

Title.Text = "üéØ Snipe Tool"
Title.Size = UDim2.new(1, 0, 0, 30)
Title.BackgroundTransparency = 1
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 18

TextBox.PlaceholderText = "Enter Username..."
TextBox.Size = UDim2.new(0.9, 0, 0, 30)
TextBox.Position = UDim2.new(0.05,0,0.3,0)
TextBox.BackgroundColor3 = Color3.fromRGB(255, 170, 50)
TextBox.TextColor3 = Color3.new(1,1,1)
TextBox.Font = Enum.Font.SourceSans
TextBox.TextSize = 16

Button.Text = "üîç Start Snipe"
Button.Size = UDim2.new(0.9, 0, 0, 30)
Button.Position = UDim2.new(0.05,0,0.55,0)
Button.BackgroundColor3 = Color3.fromRGB(200,100,0)
Button.TextColor3 = Color3.new(1,1,1)
Button.Font = Enum.Font.SourceSansBold
Button.TextSize = 16

Status.Text = "Status: Idle"
Status.Size = UDim2.new(1, 0, 0, 20)
Status.Position = UDim2.new(0,0,0.85,0)
Status.BackgroundTransparency = 1
Status.TextColor3 = Color3.new(1,1,1)
Status.Font = Enum.Font.SourceSans
Status.TextSize = 14

-- Function to scan servers
local function ListServers(cursor)
    local url = Api..PlaceId.."/servers/Public?sortOrder=Asc&limit=100" .. ((cursor and "&cursor="..cursor) or "")
    local raw = game:HttpGet(url)
    return Http:JSONDecode(raw)
end

local function Copy(text)
    setclipboard(tostring(text))
end

-- Button Function
Button.MouseButton1Click:Connect(function()
    local targetName = TextBox.Text
    if targetName == "" then
        Status.Text = "Status: Enter username first!"
        return
    end
    
    Status.Text = "Status: Searching..."
    local cursor = nil
    local found = false
    
    for i = 1, 5 do -- 5 pages * 100 servers = 500 max servers
        local servers = ListServers(cursor)
        for _, server in ipairs(servers.data) do
            if server.playing > 0 then
                local success, players = pcall(function()
                    return game:GetService("Players"):GetPlayers()
                end)
                -- Instead of Local GetPlayers, check API
                local srvPlayers = server.playerIds or {}
                for _, userid in ipairs(srvPlayers) do
                    local name = game.Players:GetNameFromUserIdAsync(userid)
                    if string.lower(name) == string.lower(targetName) then
                        Status.Text = "‚úÖ Target found! Joining..."
                        Copy(server.id) -- copy JobId
                        TeleportService:TeleportToPlaceInstance(PlaceId, server.id, LocalPlayer)
                        found = true
                        break
                    end
                end
            end
            if found then break end
        end
        if found then break end
        cursor = servers.nextPageCursor
        if not cursor then break end
    end
    
    if not found then
        Status.Text = "‚ùå Target not found. Try again."
    end
end)
